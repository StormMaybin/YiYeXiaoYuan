/** * Created by p on 2016/11/15. */$(function () {    //拿值    var usr_id=window.sessionStorage.getItem('userName');    var usr_tel=window.sessionStorage.getItem('userTel');    var usr_qq=window.sessionStorage.getItem('userQQ');    //填值    $('#peo-user').val(usr_id);    $('#username').html(usr_id);    $('#userTel').html(usr_tel);    if(usr_qq!=null){        $('#userQQ').html(usr_qq);    }    $('#left-login').on('click tap',function (e) {        e.preventDefault();        window.sessionStorage.clear();        $('#dialog-exit').fadeIn(300);        setTimeout(function () {            $('#dialog-exit').fadeOut(300);            window.location.href='index.html';        },2000);    });//清除session  并退出登录    $('#userQQ').on('tap click',function () {        window.location.href='setQQ.html';    });    //修改登录密码js  //修改登录密码js  //修改登录密码js    $('#login-get').on('tap click',function (e) {        e.preventDefault();        var $set_password1=$('#set_password1').val();        var $set_password2=$('#set_password2').val();        //先判断两个的长度 然后判断两个是否相等        if(($set_password1.length<6||$set_password1.length>16)||($set_password2.length<6||$set_password2.length>16)){            $('#dialog-password_error1').fadeIn(300);            setTimeout(function () {                $('#dialog-password_error1').fadeOut(300);            },2000);            return false;        }else{            if($set_password1!=$set_password2){                $('#dialog-password_error2').fadeIn(300);                setTimeout(function () {                    $('#dialog-password_error2').fadeOut(300);                },2000);                return false;            }else{                $.ajax({                    type:'post',                    url:'servlet/RegisterServlet',                    dataType:'json',                    data:{                    	'type':window.sessionStorage.getItem('type'),                        'mobile':usr_tel,                        'passWord':$set_password1                    },                    success:function (data) {                        //0失败  1 成功                        if(data.type==1){                            if(data.status==0){                                $('#dialog-password_error3').fadeIn(300);                                setTimeout(function () {                                    $('#dialog-password_error3').fadeOut(300);                                },2000);                                return false;                            }                            if(data.status==1){                                $('#dialog-password_success').fadeIn(300);                                setTimeout(function () {                                    $('#dialog-password_success').fadeOut(300);                                    window.location.href='myRoute.html';                                },2000);                            }                        }//注册时设置密码                        if(data.type==2){                            $('#dialog-password_error4').fadeIn(300);                            setTimeout(function () {                                $('#dialog-password_error4').fadeOut(300);                                window.history.go(-1);                            },2000);                            return false;                        }//注册后改变密码                        if(data.type==3){                            $('#dialog-password_error5').fadeIn(300);                            setTimeout(function () {                                $('#dialog-password_error5').fadeOut(300);                                window.location.href='login.html';                            },2000);                            return false;                        }//重置密码                    },                    error:function () {                        alert('net wrong');                    }                });            }        }    });    //设置用户名    //setUsername    $('#user-name').on('click tap',function(e){        e.preventDefault();        var $userName=$('#input-name').val();        var regUser1=/[a-zA-Z]{4,16}/;        var regUser2=/[\u4e00-\u9fa5]{2,8}/;        if(regUser1.test($userName)==true||regUser2.test(regUser2)==true){            $.ajax({                type:'post',                url:'',                data:{                    'usr_id':'',                    'new_usr_id':$userName                    //发送原id 和改过的id                },                dataType:'xml',                success:function (data) {                    if(data==1){                        $('#set_rsp_txt').html('修改成功！');                        $('#set_rsp').slideDown(300);                        setTimeout(function () {                            $('#set_rsp').slideUp(300);                            history.go(-1);                        },2000);                    }                    if(data==0){                        $('#set_rsp_txt').html('用户名已被他人使用！');                        $('#set_rsp').slideDown(300);                        setTimeout(function () {                            $('#set_rsp').slideUp(300);                        },2000);                    }                },                error:function () {                    alert('net wrong');                }            });        }else{            $('#set_rsp_txt').html('用户名格式不对');            $('#set_rsp').slideDown(300);            setTimeout(function () {                $('#set_rsp').slideUp(300);            },3000);        }    });    //set qq    $('#set_qq').on('tap click',function (e) {        e.preventDefault();        var $set_qq=$('#input-QQ').val();        if ($set_qq==''){            $('#setqq_rsp_txt').html('QQ不能为空！');            $('#setqq_rsp').slideDown(300);            setTimeout(function () {                $('#setqq_rsp').slideUp(300);            },2000);            return false;        }        $.ajax({            type:'post',            url:'servlet/SetQQServlet',            data:{                'qq':$set_qq,                'mobile':usr_tel            },            dataType:'json',            success:function (data) {                if(data.status==1){                    window.sessionStorage.setItem('userQQ',$set_qq);                    $('#setqq_rsp_txt').html('设置成功');                    $('#setqq_rsp').slideDown(300);                    setTimeout(function () {                        history.go(-1);                        $('#setqq_rsp').slideUp(300);                    },2000);                }                if(data.status==0){                    $('#setqq_rsp_txt').html('设置失败');                    $('#setqq_rsp').slideDown(300);                    setTimeout(function () {                        $('#setqq_rsp').slideUp(300);                    },2000);                    return false;                }            },            error:function (XHR) {                alert('net wrong');            }        });    })});