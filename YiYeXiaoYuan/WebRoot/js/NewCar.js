/** * Created by YZY on 2016/11/4. */$(function(){    $(".fache-replace").click(        function () {            var o1 = $(".fache-start").html();            $(".fache-start").html($(".fache-end").html());            $(".fache-end").html(o1);        });    //console.log(localStorage);    var aaa=localStorage.getItem("whereStart");    var bbb=localStorage.getItem("whereEnd");    if(!aaa=="")    {        $("#where-start").html(aaa);    }    if(!bbb=="")    {        $("#where-end").html(bbb);    };    var nowTemp = new Date();    var nowDay = new Date(nowTemp.getFullYear(), nowTemp.getMonth(), nowTemp.getDate(), 0, 0, 0, 0).valueOf();    var nowAfterDay=nowDay+31*2*24*60*60*1000;    // alert(nowDay+"aaa"+nowAfterDay);    var nowMoth = new Date(nowTemp.getFullYear(), nowTemp.getMonth(), 1, 0, 0, 0, 0).valueOf();    var nowYear = new Date(nowTemp.getFullYear(), 0, 1, 0, 0, 0, 0).valueOf();    var $myStart2 = $('#one-date');    var checkin = $myStart2.datepicker({        theme:"danger",        onRender: function(date, viewMode) {            // 默认 days 视图，与当前日期比较            var viewDate = nowDay;            switch (viewMode) {                // moths 视图，与当前月份比较                case 1:                    viewDate = nowMoth;                    break;                // years 视图，与当前年份比较                case 2:                    viewDate = nowYear;                    break;            }            return date.valueOf() > nowAfterDay ? 'am-disabled' : ''||date.valueOf() < viewDate ? 'am-disabled' : '';        }    });    //yzy    function check_login() {        var status=null;        $.ajax({            method:'get',            url:'',            dataType:'json',            cache:false,            success:function (data) {                if(data.status==1){status=1;}//login ed                if(data.status==0){status=0;}//un login            }        });        return status;    }//判断是否登录    $('#start_btn').on('click tap', function (e) {        e.preventDefault();        if(1==1) {            var message=$('#message').val();            var reg=/[0-9]{5,}/g;            if(reg.test(message)==true){                $('#dialog-check').fadeIn(300);                setTimeout(function () {                    $('#dialog-check').fadeOut(300);                },3000);                return false            }//首先判断备注是否合法            var min_m=$('#startTime_min_min').val();            var min_h=$('#startTime_min_hour').val();            var max_m= $('#startTime_max_min').val();            var max_h=$('#startTime_max_hour').val();            //判断时间的合法            function change_time() {                var t1;                t1=max_h;                max_h=min_h;                min_h=t1;                var t2;                t2=max_m;                max_m=min_m;                min_m=t2;            }            if(max_h>min_h){}            if(max_h<min_h){change_time();}            if(max_h==min_h){                if(max_m>=min_m){}                if(max_m<min_m){change_time();}            }            $('#startTime_min_min').val(min_m);            $('#startTime_min_hour').val(min_h);            $('#startTime_max_min').val(max_m);            $('#startTime_max_hour').val(max_h);            ////正确显示所选时间            if($myStart2.attr('value')==undefined||$('#curtMember').val()==''||$('#maxMember').val()==''||$('#curtMember').val()>=$('#maxMember').val()) {                $('#dialog-error').fadeIn(300);                setTimeout(function () {                    $('#dialog-error').fadeOut(300);                },2000);                return false;            }            if($('#maxMember').val()>6){                $('#dialog-error2').fadeIn(300);                setTimeout(function () {                    $('#dialog-error2').fadeOut(300);                },2000);                return false;            }            //判断表单填写的完整性            $.ajax({                method: 'post',                url: '',                dataType: 'json',                data: {                    ' startDate':$myStart2.attr('value'),                    'startPos': $('#where-start').html(),                    'arrivePos': $('#where-end').html(),                    'startTime_min_hour': min_h,                    'startTime_min_min': min_m,                    'startTime_max_hour': max_h,                    'startTime_max_min': max_m,                    'maxMember': $('#maxMember').val(),                    'curtMember:': $('#curtMember').val(),                    'message':message                    //usr id!!!没写                },                success: function (data) {                    //                },                error: function (jqXHR) {                    alert('wrong' + jqXHR.status + jqXHR.readyState);                }            });//发送表单数据至后台        } else{            $('#dialog-login').fadeIn(300);            setTimeout(function () {                location.href='登陆.html';            },3000)        }    });//发布新拼车 按钮事件});